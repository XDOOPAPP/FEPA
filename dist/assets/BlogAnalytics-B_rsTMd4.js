import{j as s}from"./vendor-CIDEvgjn.js";import{r as e}from"./react-YvAU7kAw.js";import{R as a,P as t,a as l,C as i,T as r,L as n,B as o,b as c,X as d,Y as h,c as j}from"./recharts-B4hB0_p6.js";import{b as x}from"./blogAPI-DJm8VOYx.js";import{d as m,e as u,k as p,B as g,n as f,h as y,i as v,C as b,u as B,W as E,X as C,E as S}from"./antd-Bnai4W4o.js";import{L as w,e as F}from"./index-C6bCr4XE.js";import{e as N}from"./exportUtils-CGhWYdho.js";import{R as k}from"./PieChartOutlined-57ONh_SH.js";import{R as P}from"./CloseCircleOutlined-BYmjHuxT.js";import"./socket-CUkmNz_4.js";const T=["#0EA5E9","#10B981","#F59E0B","#F43F5E"];function K(){const[K,$]=e.useState(m().year()),[A,L]=e.useState(!1),[R,D]=e.useState({}),[O,X]=e.useState([]),_=(R.draft||0)+(R.pending||0)+(R.published||0)+(R.rejected||0),I=async()=>{L(!0);try{const[s,e]=await Promise.all([x.getStatusStats(),x.getMonthlyStats(K)]);D(s||{}),X(e||[])}catch(s){D({}),X([])}finally{L(!1)}};e.useEffect(()=>{I()},[K]);const M=[{name:"Nháp",value:R.draft||0,color:"#94a3b8"},{name:"Chờ duyệt",value:R.pending||0,color:"#F59E0B"},{name:"Đã xuất bản",value:R.published||0,color:"#10B981"},{name:"Bị từ chối",value:R.rejected||0,color:"#F43F5E"}].filter(s=>s.value>0),U=O.length?O.map(s=>({month:`Th${s.month}`,count:s.count})):[],V=_>0||U.length>0;return s.jsx(w,{loading:A,children:s.jsxs("div",{style:{padding:24},children:[s.jsxs(u,{style:{width:"100%",justifyContent:"space-between",marginBottom:16},children:[s.jsxs("h2",{style:{margin:0},children:[s.jsx(k,{})," Phân tích Blog"]}),s.jsxs(u,{children:[s.jsx(p,{value:K,onChange:s=>$(s),options:[2024,2025,2026,2027].map(s=>({label:s,value:s}))}),s.jsx(g,{icon:s.jsx(f,{}),onClick:I,children:"Làm mới"}),s.jsx(g,{onClick:()=>N(M.map(s=>({"Trạng_thái":s.name,"Số_lượng":s.value})),{filename:`blog-status-${K}`}),children:"Export CSV"})]})]}),s.jsxs(y,{gutter:16,style:{marginBottom:16},children:[s.jsx(v,{span:6,children:s.jsx(b,{className:"shadow-card",children:s.jsx(B,{title:"Tổng bài viết",value:_,prefix:s.jsx(E,{})})})}),s.jsx(v,{span:6,children:s.jsx(b,{className:"shadow-card",children:s.jsx(B,{title:"Chờ duyệt",value:R.pending||0,prefix:s.jsx(C,{style:{color:"#F59E0B"}}),valueStyle:{color:"#F59E0B"}})})}),s.jsx(v,{span:6,children:s.jsx(b,{className:"shadow-card",children:s.jsx(B,{title:"Đã xuất bản",value:R.published||0,prefix:s.jsx(F,{style:{color:"#10B981"}}),valueStyle:{color:"#10B981"}})})}),s.jsx(v,{span:6,children:s.jsx(b,{className:"shadow-card",children:s.jsx(B,{title:"Bị từ chối",value:R.rejected||0,prefix:s.jsx(P,{style:{color:"#F43F5E"}}),valueStyle:{color:"#F43F5E"}})})})]}),V?s.jsxs(y,{gutter:16,children:[s.jsx(v,{span:10,children:s.jsx(b,{className:"shadow-card",title:"Tỷ lệ theo trạng thái",children:s.jsx("div",{style:{height:320},children:s.jsx(a,{width:"100%",height:"100%",children:s.jsxs(t,{children:[s.jsx(l,{dataKey:"value",nameKey:"name",data:M,label:!0,children:M.map((e,a)=>s.jsx(i,{fill:e.color||T[a%T.length]},`cell-${a}`))}),s.jsx(r,{}),s.jsx(n,{})]})})})})}),s.jsx(v,{span:14,children:s.jsx(b,{className:"shadow-card",title:`Số bài viết theo tháng (${K})`,children:s.jsx("div",{style:{height:320},children:s.jsx(a,{width:"100%",height:"100%",children:s.jsxs(o,{data:U,children:[s.jsx(c,{strokeDasharray:"3 3"}),s.jsx(d,{dataKey:"month"}),s.jsx(h,{allowDecimals:!1}),s.jsx(r,{}),s.jsx(j,{dataKey:"count",fill:"#0EA5E9",radius:[6,6,0,0]})]})})})})})]}):s.jsx(b,{children:s.jsx(S,{description:"Chưa có dữ liệu thống kê"})})]})})}export{K as default};
