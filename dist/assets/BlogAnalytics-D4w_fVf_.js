import{j as s}from"./vendor-CIDEvgjn.js";import{r as e}from"./react-YvAU7kAw.js";import{R as a,P as t,a as l,C as i,T as r,L as n,B as o,b as c,X as d,Y as h,c as j}from"./recharts-OKR9gfyr.js";import{b as x}from"./blogAPI-FLO4H6ir.js";import{d as m,e as u,w as p,B as g,O as f,h as y,i as v,C as b,p as B,W as E,X as w,E as C}from"./antd-Ca0_LWAN.js";import{L as S,e as F}from"./index-DEkLrubD.js";import{e as N}from"./exportUtils-CGhWYdho.js";import{R as k}from"./PieChartOutlined-U9C0tV0i.js";import{R as P}from"./CloseCircleOutlined-BsKjmxrd.js";import"./socket-CUkmNz_4.js";const T=["#0EA5E9","#10B981","#F59E0B","#F43F5E"];function K(){const[K,$]=e.useState(m().year()),[A,L]=e.useState(!1),[O,R]=e.useState({}),[D,X]=e.useState([]),_=(O.draft||0)+(O.pending||0)+(O.published||0)+(O.rejected||0),q=async()=>{L(!0);try{const[s,e]=await Promise.all([x.getStatusStats(),x.getMonthlyStats(K)]);R(s||{}),X(e||[])}catch(s){R({}),X([])}finally{L(!1)}};e.useEffect(()=>{q()},[K]);const I=[{name:"Nháp",value:O.draft||0,color:"#94a3b8"},{name:"Chờ duyệt",value:O.pending||0,color:"#F59E0B"},{name:"Đã xuất bản",value:O.published||0,color:"#10B981"},{name:"Bị từ chối",value:O.rejected||0,color:"#F43F5E"}].filter(s=>s.value>0),M=D.length?D.map(s=>({month:`Th${s.month}`,count:s.count})):[],U=_>0||M.length>0;return s.jsx(S,{loading:A,children:s.jsxs("div",{style:{padding:24},children:[s.jsxs(u,{style:{width:"100%",justifyContent:"space-between",marginBottom:16},children:[s.jsxs("h2",{style:{margin:0},children:[s.jsx(k,{})," Phân tích Blog"]}),s.jsxs(u,{children:[s.jsx(p,{value:K,onChange:s=>$(s),options:[2024,2025,2026,2027].map(s=>({label:s,value:s}))}),s.jsx(g,{icon:s.jsx(f,{}),onClick:q,children:"Làm mới"}),s.jsx(g,{onClick:()=>N(I.map(s=>({"Trạng_thái":s.name,"Số_lượng":s.value})),{filename:`blog-status-${K}`}),children:"Export CSV"})]})]}),s.jsxs(y,{gutter:16,style:{marginBottom:16},children:[s.jsx(v,{span:6,children:s.jsx(b,{className:"shadow-card",children:s.jsx(B,{title:"Tổng bài viết",value:_,prefix:s.jsx(E,{})})})}),s.jsx(v,{span:6,children:s.jsx(b,{className:"shadow-card",children:s.jsx(B,{title:"Chờ duyệt",value:O.pending||0,prefix:s.jsx(w,{style:{color:"#F59E0B"}}),valueStyle:{color:"#F59E0B"}})})}),s.jsx(v,{span:6,children:s.jsx(b,{className:"shadow-card",children:s.jsx(B,{title:"Đã xuất bản",value:O.published||0,prefix:s.jsx(F,{style:{color:"#10B981"}}),valueStyle:{color:"#10B981"}})})}),s.jsx(v,{span:6,children:s.jsx(b,{className:"shadow-card",children:s.jsx(B,{title:"Bị từ chối",value:O.rejected||0,prefix:s.jsx(P,{style:{color:"#F43F5E"}}),valueStyle:{color:"#F43F5E"}})})})]}),U?s.jsxs(y,{gutter:16,children:[s.jsx(v,{span:10,children:s.jsx(b,{className:"shadow-card",title:"Tỷ lệ theo trạng thái",children:s.jsx("div",{style:{height:320},children:s.jsx(a,{width:"100%",height:"100%",children:s.jsxs(t,{children:[s.jsx(l,{dataKey:"value",nameKey:"name",data:I,label:!0,children:I.map((e,a)=>s.jsx(i,{fill:e.color||T[a%T.length]},`cell-${a}`))}),s.jsx(r,{}),s.jsx(n,{})]})})})})}),s.jsx(v,{span:14,children:s.jsx(b,{className:"shadow-card",title:`Số bài viết theo tháng (${K})`,children:s.jsx("div",{style:{height:320},children:s.jsx(a,{width:"100%",height:"100%",children:s.jsxs(o,{data:M,children:[s.jsx(c,{strokeDasharray:"3 3"}),s.jsx(d,{dataKey:"month"}),s.jsx(h,{allowDecimals:!1}),s.jsx(r,{}),s.jsx(j,{dataKey:"count",fill:"#0EA5E9",radius:[6,6,0,0]})]})})})})})]}):s.jsx(b,{children:s.jsx(C,{description:"Chưa có dữ liệu thống kê"})})]})})}export{K as default};
