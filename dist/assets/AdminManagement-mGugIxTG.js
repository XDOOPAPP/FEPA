import{u as e,c as s,b as i,j as r}from"./vendor-CIDEvgjn.js";import{r as a}from"./react-YvAU7kAw.js";import{a as n}from"./adminAPI-osqYiyjh.js";import{F as l,T as t,B as d,G as o,h as c,i as h,C as m,t as x,z as u,N as j,f as p,e as y,u as g,s as f}from"./antd-B4HmBe3_.js";import{c as v,e as A,h as k,i as w,j as C}from"./index-CWIbmrm_.js";import{R as N}from"./CloseCircleOutlined-BTaVCU99.js";import"./socket-CUkmNz_4.js";const{Title:I,Text:S}=t;function V(){const[t,V]=a.useState(!1),[T]=l.useForm(),b=e(),{data:z,isLoading:P}=s({queryKey:["admins"],queryFn:n.getAllAdmins}),q=i({mutationFn:n.registerAdmin,onSuccess:()=>{f.success("Admin đã được tạo thành công!"),b.invalidateQueries({queryKey:["admins"]}),V(!1),T.resetFields()},onError:e=>{f.error(e.message||"Có lỗi xảy ra khi tạo admin")}}),F=()=>{V(!1),T.resetFields()},M=[{title:"Email",dataIndex:"email",key:"email",width:250,render:e=>r.jsxs(y,{children:[r.jsx(w,{style:{color:"var(--primary)"}}),r.jsx(S,{children:e})]})},{title:"Họ và tên",dataIndex:"fullName",key:"fullName",width:200,render:e=>r.jsxs(y,{children:[r.jsx(v,{style:{color:"var(--text-secondary)"}}),r.jsx(S,{strong:!0,children:e})]})},{title:"Vai trò",dataIndex:"role",key:"role",width:150,render:e=>r.jsx(g,{icon:r.jsx(k,{}),color:"SUPER_ADMIN"===e?"gold":"blue",children:"SUPER_ADMIN"===e?"Super Admin":"Admin"})},{title:"Trạng thái",key:"status",width:150,render:(e,s)=>r.jsxs(y,{direction:"vertical",size:4,children:[r.jsx(g,{icon:s.isVerified?r.jsx(A,{}):r.jsx(N,{}),color:s.isVerified?"success":"warning",children:s.isVerified?"Đã xác thực":"Chưa xác thực"}),r.jsx(g,{color:s.isActive?"success":"default",children:s.isActive?"Hoạt động":"Tạm khóa"})]})},{title:"Ngày tạo",dataIndex:"createdAt",key:"createdAt",width:180,render:e=>new Date(e).toLocaleDateString("vi-VN",{year:"numeric",month:"long",day:"numeric"})}],E=z||{},H=Array.isArray(E.data)?E.data:Array.isArray(E.users)?E.users:Array.isArray(E.items)?E.items:Array.isArray(E)?E:[],D=H.length,B=H.filter(e=>e.isVerified).length,K=H.filter(e=>e.isActive).length;return r.jsxs("div",{style:{padding:"24px"},children:[r.jsx("div",{style:{marginBottom:"24px"},children:r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("div",{children:[r.jsx(I,{level:2,style:{margin:0},children:"Quản lý Admin"}),r.jsx(S,{type:"secondary",children:"Quản lý danh sách tài khoản quản trị viên"})]}),r.jsx(d,{type:"primary",icon:r.jsx(o,{}),size:"large",onClick:()=>V(!0),children:"Tạo Admin Mới"})]})}),r.jsxs(c,{gutter:16,style:{marginBottom:"24px"},children:[r.jsx(h,{span:8,children:r.jsx(m,{className:"shadow-card",children:r.jsx(x,{title:"Tổng số Admin",value:D,prefix:r.jsx(v,{style:{color:"var(--primary)"}}),valueStyle:{color:"var(--primary)"}})})}),r.jsx(h,{span:8,children:r.jsx(m,{className:"shadow-card",children:r.jsx(x,{title:"Admin đã xác thực",value:B,prefix:r.jsx(A,{style:{color:"var(--success)"}}),valueStyle:{color:"var(--success)"}})})}),r.jsx(h,{span:8,children:r.jsx(m,{className:"shadow-card",children:r.jsx(x,{title:"Admin đang hoạt động",value:K,prefix:r.jsx(k,{style:{color:"var(--info)"}}),valueStyle:{color:"var(--info)"}})})})]}),r.jsx(m,{className:"shadow-card",children:r.jsx(u,{columns:M,dataSource:H,loading:P,rowKey:e=>e.id||e._id||e.email,pagination:{pageSize:10,showTotal:e=>`Tổng số ${e} admin`,showSizeChanger:!0}})}),r.jsx(j,{title:r.jsxs(y,{children:[r.jsx(o,{}),r.jsx("span",{children:"Tạo Admin Mới"})]}),open:t,onClose:F,width:480,footer:r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[r.jsx(d,{onClick:F,children:"Hủy"}),r.jsx(d,{type:"primary",onClick:()=>T.submit(),loading:q.isPending,children:"Tạo Admin"})]}),children:r.jsxs(l,{form:T,layout:"vertical",onFinish:async e=>{q.mutate(e)},autoComplete:"off",children:[r.jsx(l.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Vui lòng nhập email!"},{type:"email",message:"Email không hợp lệ!"}],children:r.jsx(p,{prefix:r.jsx(w,{}),placeholder:"admin@example.com",size:"large"})}),r.jsx(l.Item,{name:"fullName",label:"Họ và tên",rules:[{required:!0,message:"Vui lòng nhập họ và tên!"},{min:3,message:"Họ và tên phải có ít nhất 3 ký tự!"}],children:r.jsx(p,{prefix:r.jsx(v,{}),placeholder:"Nguyễn Văn A",size:"large"})}),r.jsx(l.Item,{name:"password",label:"Mật khẩu",rules:[{required:!0,message:"Vui lòng nhập mật khẩu!"},{min:6,message:"Mật khẩu phải có ít nhất 6 ký tự!"}],extra:"Mật khẩu nên có ít nhất 8 ký tự, bao gồm chữ hoa, chữ thường và số",children:r.jsx(p.Password,{prefix:r.jsx(C,{}),placeholder:"••••••••",size:"large"})}),r.jsx(l.Item,{name:"confirmPassword",label:"Xác nhận mật khẩu",dependencies:["password"],rules:[{required:!0,message:"Vui lòng xác nhận mật khẩu!"},({getFieldValue:e})=>({validator:(s,i)=>i&&e("password")!==i?Promise.reject(new Error("Mật khẩu xác nhận không khớp!")):Promise.resolve()})],children:r.jsx(p.Password,{prefix:r.jsx(C,{}),placeholder:"••••••••",size:"large"})})]})})]})}export{V as default};
