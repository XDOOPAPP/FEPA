import{j as e}from"./vendor-CIDEvgjn.js";import{r as t}from"./react-YvAU7kAw.js";import{I as n,_ as s,F as r,d as a,C as i,w as l,e as c,B as o,x as d,y as h,f as p,j as u,J as g,z as x,u as m,K as j,G as y,R as S,s as f}from"./antd-BDFa4u8q.js";var b={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 632H136v-39.9l138.5-164.3 150.1 178L658.1 489 888 761.6V792zm0-129.8L664.2 396.8c-3.2-3.8-9-3.8-12.2 0L424.6 666.4l-144-170.7c-3.2-3.8-9-3.8-12.2 0L136 652.7V232h752v430.2zM304 456a88 88 0 100-176 88 88 0 000 176zm0-116c15.5 0 28 12.5 28 28s-12.5 28-28 28-28-12.5-28-28 12.5-28 28-28z"}}]},name:"picture",theme:"outlined"},v=function(e,r){return t.createElement(n,s({},e,{ref:r,icon:b}))},k=t.forwardRef(v);const{RangePicker:I}=g,z=()=>{const[n,s]=t.useState([]),[g,b]=t.useState(!1),[v,z]=t.useState(null),[O]=r.useForm(),[F,T]=t.useState(!1);t.useEffect(()=>{const e=localStorage.getItem("advertisements");if(e)s(JSON.parse(e));else{const e=[{id:"1",title:"Banner Ngân hàng ABC - Thẻ tín dụng",partnerId:"p1",partnerName:"Ngân hàng ABC",bannerUrl:"https://placehold.co/728x90/4CAF50/FFF?text=Ngan+hang+ABC",targetUrl:"https://bank-abc.com/credit-card",position:"home",type:"banner",status:"active",startDate:a().subtract(10,"day").toISOString(),endDate:a().add(20,"day").toISOString(),impressions:125e3,clicks:3750,ctr:3,budget:5e7,spent:15e6,createdAt:a().subtract(10,"day").toISOString()},{id:"2",title:"Banner Bảo hiểm XYZ",partnerId:"p2",partnerName:"Bảo hiểm XYZ",bannerUrl:"https://placehold.co/300x250/2196F3/FFF?text=Bao+hiem+XYZ",targetUrl:"https://insurance-xyz.com",position:"sidebar",type:"banner",status:"active",startDate:a().subtract(5,"day").toISOString(),endDate:a().add(25,"day").toISOString(),impressions:85e3,clicks:2125,ctr:2.5,budget:3e7,spent:8e6,createdAt:a().subtract(5,"day").toISOString()},{id:"3",title:"Native Ad - App Đầu tư DEF",partnerId:"p3",partnerName:"Công ty Đầu tư DEF",bannerUrl:"https://placehold.co/400x400/FF9800/FFF?text=Dau+tu+DEF",targetUrl:"https://invest-def.com/app",position:"blog",type:"native",status:"paused",startDate:a().subtract(15,"day").toISOString(),endDate:a().subtract(1,"day").toISOString(),impressions:45e3,clicks:1350,ctr:3,budget:2e7,spent:2e7,createdAt:a().subtract(15,"day").toISOString()}];s(e),localStorage.setItem("advertisements",JSON.stringify(e))}},[]);const D=e=>{s(e),localStorage.setItem("advertisements",JSON.stringify(e))},B=e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e),N=[{title:"Banner",dataIndex:"bannerUrl",key:"bannerUrl",width:120,render:t=>e.jsx("div",{style:{width:"100px",height:"60px",backgroundColor:"#f0f0f0",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"4px",overflow:"hidden"},children:e.jsx("img",{src:t,alt:"banner",style:{width:"100%",height:"100%",objectFit:"cover"},onError:e=>{e.currentTarget.style.display="none",e.currentTarget.parentElement.innerHTML='<span style="color: #999; font-size: 12px;">Banner</span>'}})})},{title:"Thông tin",key:"info",render:(t,n)=>e.jsxs(c,{direction:"vertical",size:0,children:[e.jsx("strong",{children:n.title}),e.jsxs("span",{style:{fontSize:"12px",color:"#666"},children:["Đối tác: ",n.partnerName]}),e.jsxs(c,{size:4,children:[e.jsx(m,{children:"banner"===n.type?"Banner":"popup"===n.type?"Popup":"Native"}),e.jsx(m,{color:"blue",children:"home"===n.position?"Trang chủ":"blog"===n.position?"Blog":"reports"===n.position?"Báo cáo":"Sidebar"})]})]})},{title:"Thời gian",key:"duration",render:(t,n)=>e.jsxs(c,{direction:"vertical",size:0,children:[e.jsxs("span",{style:{fontSize:"12px"},children:["Bắt đầu: ",a(n.startDate).format("DD/MM/YYYY")]}),e.jsxs("span",{style:{fontSize:"12px"},children:["Kết thúc: ",a(n.endDate).format("DD/MM/YYYY")]})]})},{title:"Hiệu suất",key:"performance",render:(t,n)=>e.jsxs(c,{direction:"vertical",size:0,children:[e.jsxs("span",{style:{fontSize:"12px"},children:["Hiển thị: ",(n.impressions||0).toLocaleString()]}),e.jsxs("span",{style:{fontSize:"12px"},children:["Click: ",(n.clicks||0).toLocaleString()]}),e.jsxs("span",{style:{fontSize:"12px",color:(n.ctr||0)>=3?"#52c41a":"#faad14"},children:["CTR: ",(n.ctr||0).toFixed(2),"%"]})]})},{title:"Ngân sách",key:"budget",render:(t,n)=>e.jsxs(c,{direction:"vertical",size:0,children:[e.jsxs("span",{style:{fontSize:"12px"},children:["Tổng: ",B(n.budget)]}),e.jsxs("span",{style:{fontSize:"12px"},children:["Đã dùng: ",B(n.spent)]}),e.jsxs("span",{style:{fontSize:"12px",color:n.spent>=n.budget?"#ff4d4f":"#52c41a"},children:["Còn: ",B(n.budget-n.spent)]})]})},{title:"Trạng thái",dataIndex:"status",key:"status",render:t=>{const{color:n,text:s}={active:{color:"success",text:"Đang chạy"},paused:{color:"warning",text:"Tạm dừng"},ended:{color:"default",text:"Đã kết thúc"}}[t];return e.jsx(m,{color:n,children:s})},filters:[{text:"Đang chạy",value:"active"},{text:"Tạm dừng",value:"paused"},{text:"Đã kết thúc",value:"ended"}],onFilter:(e,t)=>t.status===e},{title:"Thao tác",key:"action",width:150,render:(t,s)=>e.jsxs(c,{children:[e.jsx(o,{type:"link",icon:e.jsx(j,{}),size:"small",children:"Xem"}),e.jsx(o,{type:"link",icon:e.jsx(y,{}),size:"small",onClick:()=>{return z(e=s),O.setFieldsValue({...e,dateRange:[a(e.startDate),a(e.endDate)]}),void b(!0);var e},children:"Sửa"}),e.jsx(o,{type:"link",danger:!0,icon:e.jsx(S,{}),size:"small",onClick:()=>{return e=s.id,void h.confirm({title:"Xác nhận xóa",content:"Bạn có chắc chắn muốn xóa quảng cáo này?",okText:"Xóa",cancelText:"Hủy",okButtonProps:{danger:!0},onOk:()=>{const t=n.filter(t=>t.id!==e);D(t),f.success("Đã xóa quảng cáo")}});var e},children:"Xóa"})]})}],q={total:n.length,active:n.filter(e=>"active"===e.status).length,totalBudget:n.reduce((e,t)=>e+t.budget,0),totalSpent:n.reduce((e,t)=>e+t.spent,0),totalImpressions:n.reduce((e,t)=>e+t.impressions,0),totalClicks:n.reduce((e,t)=>e+t.clicks,0)};return e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(i,{title:e.jsxs(c,{children:[e.jsx(k,{}),e.jsx("span",{children:"Quản lý Quảng cáo & Banner"})]}),extra:e.jsxs(c,{direction:"vertical",size:4,align:"end",children:[e.jsxs(c,{children:[e.jsxs("span",{children:["Đang chạy: ",q.active,"/",q.total]}),e.jsxs("span",{children:["| Hiển thị: ",q.totalImpressions.toLocaleString()]}),e.jsxs("span",{children:["| Click: ",q.totalClicks.toLocaleString()]})]}),e.jsx(o,{type:"primary",icon:e.jsx(d,{}),onClick:()=>{z(null),O.resetFields(),O.setFieldsValue({status:"active",type:"banner",position:"home"}),b(!0)},children:"Thêm quảng cáo"})]}),children:e.jsx(l,{columns:N,dataSource:n,rowKey:"id",pagination:{pageSize:10}})}),e.jsx(h,{title:v?"Sửa quảng cáo":"Thêm quảng cáo mới",open:g,onOk:async()=>{try{T(!0);const e=await O.validateFields(),[t,s]=e.dateRange;if(v){const r=n.map(n=>n.id===v.id?{...n,...e,startDate:t.toISOString(),endDate:s.toISOString()}:n);D(r),f.success("Cập nhật quảng cáo thành công")}else{const r={id:Date.now().toString(),...e,startDate:t.toISOString(),endDate:s.toISOString(),impressions:0,clicks:0,ctr:0,spent:0,createdAt:a().toISOString()};D([...n,r]),f.success("Thêm quảng cáo thành công")}b(!1),O.resetFields()}catch(e){}finally{T(!1)}},onCancel:()=>{b(!1),O.resetFields()},width:700,okText:"Lưu",cancelText:"Hủy",confirmLoading:F,children:e.jsxs(r,{form:O,layout:"vertical",children:[e.jsx(r.Item,{name:"title",label:"Tiêu đề quảng cáo",rules:[{required:!0,message:"Vui lòng nhập tiêu đề"}],children:e.jsx(p,{placeholder:"Nhập tiêu đề quảng cáo"})}),e.jsx(r.Item,{name:"partnerName",label:"Tên đối tác",rules:[{required:!0,message:"Vui lòng nhập tên đối tác"}],children:e.jsx(p,{placeholder:"Tên công ty/đối tác"})}),e.jsx(r.Item,{name:"bannerUrl",label:"URL Banner/Hình ảnh",rules:[{required:!0,message:"Vui lòng nhập URL banner"}],children:e.jsx(p,{placeholder:"https://example.com/banner.jpg"})}),e.jsx(r.Item,{name:"targetUrl",label:"URL đích (khi click)",rules:[{required:!0,message:"Vui lòng nhập URL đích"}],children:e.jsx(p,{placeholder:"https://partner-website.com"})}),e.jsxs(c,{style:{width:"100%"},size:"large",children:[e.jsx(r.Item,{name:"type",label:"Loại quảng cáo",rules:[{required:!0}],style:{flex:1},children:e.jsxs(u,{children:[e.jsx(u.Option,{value:"banner",children:"Banner"}),e.jsx(u.Option,{value:"popup",children:"Popup"}),e.jsx(u.Option,{value:"native",children:"Native Ad"})]})}),e.jsx(r.Item,{name:"position",label:"Vị trí hiển thị",rules:[{required:!0}],style:{flex:1},children:e.jsxs(u,{children:[e.jsx(u.Option,{value:"home",children:"Trang chủ"}),e.jsx(u.Option,{value:"blog",children:"Blog"}),e.jsx(u.Option,{value:"reports",children:"Báo cáo"}),e.jsx(u.Option,{value:"sidebar",children:"Sidebar"})]})})]}),e.jsx(r.Item,{name:"dateRange",label:"Thời gian chạy",rules:[{required:!0,message:"Vui lòng chọn thời gian"}],children:e.jsx(I,{style:{width:"100%"},format:"DD/MM/YYYY"})}),e.jsxs(c,{style:{width:"100%"},size:"large",children:[e.jsx(r.Item,{name:"budget",label:"Ngân sách (VNĐ)",rules:[{required:!0,message:"Vui lòng nhập ngân sách"}],style:{flex:1},children:e.jsx(x,{style:{width:"100%"},min:0,formatter:e=>`${e}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),placeholder:"10000000"})}),e.jsx(r.Item,{name:"status",label:"Trạng thái",rules:[{required:!0}],style:{flex:1},children:e.jsxs(u,{children:[e.jsx(u.Option,{value:"active",children:"Đang chạy"}),e.jsx(u.Option,{value:"paused",children:"Tạm dừng"}),e.jsx(u.Option,{value:"ended",children:"Đã kết thúc"})]})})]})]})})]})};export{z as default};
