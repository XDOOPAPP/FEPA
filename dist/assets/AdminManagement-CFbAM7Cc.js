import{u as e,c as s,b as r,j as i}from"./vendor-CIDEvgjn.js";import{r as a}from"./react-YvAU7kAw.js";import{g as n,c as t,e as l,h as d,i as o,j as c}from"./index-eiZvAwCW.js";import{F as h,T as m,B as x,x as u,h as j,i as g,C as p,t as y,w as v,H as f,f as A,e as w,u as k,s as C}from"./antd-BDFa4u8q.js";import{R as N}from"./CloseCircleOutlined-BiZJkYjc.js";import"./socket-CUkmNz_4.js";const S={registerAdmin:async e=>{var s,r;try{return await n.post("/auth/register-admin",e)}catch(i){throw new Error((null==(r=null==(s=i.response)?void 0:s.data)?void 0:r.message)||"Failed to register admin")}},getAllAdmins:async()=>{var e,s;try{return await n.get("/auth/all-admin")}catch(r){throw new Error((null==(s=null==(e=r.response)?void 0:e.data)?void 0:s.message)||"Failed to fetch admins")}}},{Title:V,Text:I}=m;function T(){const[n,m]=a.useState(!1),[T]=h.useForm(),F=e(),{data:b,isLoading:E}=s({queryKey:["admins"],queryFn:S.getAllAdmins}),q=r({mutationFn:S.registerAdmin,onSuccess:()=>{C.success("Admin đã được tạo thành công!"),F.invalidateQueries({queryKey:["admins"]}),m(!1),T.resetFields()},onError:e=>{C.error(e.message||"Có lỗi xảy ra khi tạo admin")}}),z=()=>{m(!1),T.resetFields()},M=[{title:"Email",dataIndex:"email",key:"email",width:250,render:e=>i.jsxs(w,{children:[i.jsx(o,{style:{color:"var(--primary)"}}),i.jsx(I,{children:e})]})},{title:"Họ và tên",dataIndex:"fullName",key:"fullName",width:200,render:e=>i.jsxs(w,{children:[i.jsx(t,{style:{color:"var(--text-secondary)"}}),i.jsx(I,{strong:!0,children:e})]})},{title:"Vai trò",dataIndex:"role",key:"role",width:150,render:e=>i.jsx(k,{icon:i.jsx(d,{}),color:"SUPER_ADMIN"===e?"gold":"blue",children:"SUPER_ADMIN"===e?"Super Admin":"Admin"})},{title:"Trạng thái",key:"status",width:150,render:(e,s)=>i.jsxs(w,{direction:"vertical",size:4,children:[i.jsx(k,{icon:s.isVerified?i.jsx(l,{}):i.jsx(N,{}),color:s.isVerified?"success":"warning",children:s.isVerified?"Đã xác thực":"Chưa xác thực"}),i.jsx(k,{color:s.isActive?"success":"default",children:s.isActive?"Hoạt động":"Tạm khóa"})]})},{title:"Ngày tạo",dataIndex:"createdAt",key:"createdAt",width:180,render:e=>new Date(e).toLocaleDateString("vi-VN",{year:"numeric",month:"long",day:"numeric"})}],P=b||{},H=Array.isArray(P.data)?P.data:Array.isArray(P.users)?P.users:Array.isArray(P.items)?P.items:Array.isArray(P)?P:[],D=H.length,B=H.filter(e=>e.isVerified).length,K=H.filter(e=>e.isActive).length;return i.jsxs("div",{style:{padding:"24px"},children:[i.jsx("div",{style:{marginBottom:"24px"},children:i.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[i.jsxs("div",{children:[i.jsx(V,{level:2,style:{margin:0},children:"Quản lý Admin"}),i.jsx(I,{type:"secondary",children:"Quản lý danh sách tài khoản quản trị viên"})]}),i.jsx(x,{type:"primary",icon:i.jsx(u,{}),size:"large",onClick:()=>m(!0),children:"Tạo Admin Mới"})]})}),i.jsxs(j,{gutter:16,style:{marginBottom:"24px"},children:[i.jsx(g,{span:8,children:i.jsx(p,{className:"shadow-card",children:i.jsx(y,{title:"Tổng số Admin",value:D,prefix:i.jsx(t,{style:{color:"var(--primary)"}}),valueStyle:{color:"var(--primary)"}})})}),i.jsx(g,{span:8,children:i.jsx(p,{className:"shadow-card",children:i.jsx(y,{title:"Admin đã xác thực",value:B,prefix:i.jsx(l,{style:{color:"var(--success)"}}),valueStyle:{color:"var(--success)"}})})}),i.jsx(g,{span:8,children:i.jsx(p,{className:"shadow-card",children:i.jsx(y,{title:"Admin đang hoạt động",value:K,prefix:i.jsx(d,{style:{color:"var(--info)"}}),valueStyle:{color:"var(--info)"}})})})]}),i.jsx(p,{className:"shadow-card",children:i.jsx(v,{columns:M,dataSource:H,loading:E,rowKey:e=>e.id||e._id||e.email,pagination:{pageSize:10,showTotal:e=>`Tổng số ${e} admin`,showSizeChanger:!0}})}),i.jsx(f,{title:i.jsxs(w,{children:[i.jsx(u,{}),i.jsx("span",{children:"Tạo Admin Mới"})]}),open:n,onClose:z,width:480,footer:i.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px"},children:[i.jsx(x,{onClick:z,children:"Hủy"}),i.jsx(x,{type:"primary",onClick:()=>T.submit(),loading:q.isPending,children:"Tạo Admin"})]}),children:i.jsxs(h,{form:T,layout:"vertical",onFinish:async e=>{q.mutate(e)},autoComplete:"off",children:[i.jsx(h.Item,{name:"email",label:"Email",rules:[{required:!0,message:"Vui lòng nhập email!"},{type:"email",message:"Email không hợp lệ!"}],children:i.jsx(A,{prefix:i.jsx(o,{}),placeholder:"admin@example.com",size:"large"})}),i.jsx(h.Item,{name:"fullName",label:"Họ và tên",rules:[{required:!0,message:"Vui lòng nhập họ và tên!"},{min:3,message:"Họ và tên phải có ít nhất 3 ký tự!"}],children:i.jsx(A,{prefix:i.jsx(t,{}),placeholder:"Nguyễn Văn A",size:"large"})}),i.jsx(h.Item,{name:"password",label:"Mật khẩu",rules:[{required:!0,message:"Vui lòng nhập mật khẩu!"},{min:6,message:"Mật khẩu phải có ít nhất 6 ký tự!"}],extra:"Mật khẩu nên có ít nhất 8 ký tự, bao gồm chữ hoa, chữ thường và số",children:i.jsx(A.Password,{prefix:i.jsx(c,{}),placeholder:"••••••••",size:"large"})}),i.jsx(h.Item,{name:"confirmPassword",label:"Xác nhận mật khẩu",dependencies:["password"],rules:[{required:!0,message:"Vui lòng xác nhận mật khẩu!"},({getFieldValue:e})=>({validator:(s,r)=>r&&e("password")!==r?Promise.reject(new Error("Mật khẩu xác nhận không khớp!")):Promise.resolve()})],children:i.jsx(A.Password,{prefix:i.jsx(c,{}),placeholder:"••••••••",size:"large"})})]})})]})}export{T as default};
