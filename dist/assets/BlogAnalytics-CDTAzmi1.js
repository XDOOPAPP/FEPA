import{j as s}from"./vendor-CIDEvgjn.js";import{r as e}from"./react-YvAU7kAw.js";import{R as a,P as t,d as l,e as i,T as r,a as n,B as o,C as c,X as d,Y as h,c as j}from"./recharts-Bl_pMUXE.js";import{b as x}from"./blogAPI-DuLMQIgS.js";import{d as m,e as u,j as p,B as g,m as f,h as y,i as v,C as B,t as E,X as b,Y as C,E as S}from"./antd-BDFa4u8q.js";import{L as w,e as F}from"./index-eiZvAwCW.js";import{e as N}from"./exportUtils-CGhWYdho.js";import{R as k}from"./PieChartOutlined-Dlq3oD_5.js";import{R as P}from"./CloseCircleOutlined-BiZJkYjc.js";import"./socket-CUkmNz_4.js";const T=["#0EA5E9","#10B981","#F59E0B","#F43F5E"];function K(){const[K,$]=e.useState(m().year()),[A,R]=e.useState(!1),[D,L]=e.useState({}),[O,X]=e.useState([]),Y=(D.draft||0)+(D.pending||0)+(D.published||0)+(D.rejected||0),_=async()=>{R(!0);try{const[s,e]=await Promise.all([x.getStatusStats(),x.getMonthlyStats(K)]);L(s||{}),X(e||[])}catch(s){L({}),X([])}finally{R(!1)}};e.useEffect(()=>{_()},[K]);const q=[{name:"Nháp",value:D.draft||0,color:"#94a3b8"},{name:"Chờ duyệt",value:D.pending||0,color:"#F59E0B"},{name:"Đã xuất bản",value:D.published||0,color:"#10B981"},{name:"Bị từ chối",value:D.rejected||0,color:"#F43F5E"}].filter(s=>s.value>0),I=O.length?O.map(s=>({month:`Th${s.month}`,count:s.count})):[],M=Y>0||I.length>0;return s.jsx(w,{loading:A,children:s.jsxs("div",{style:{padding:24},children:[s.jsxs(u,{style:{width:"100%",justifyContent:"space-between",marginBottom:16},children:[s.jsxs("h2",{style:{margin:0},children:[s.jsx(k,{})," Phân tích Blog"]}),s.jsxs(u,{children:[s.jsx(p,{value:K,onChange:s=>$(s),options:[2024,2025,2026,2027].map(s=>({label:s,value:s}))}),s.jsx(g,{icon:s.jsx(f,{}),onClick:_,children:"Làm mới"}),s.jsx(g,{onClick:()=>N(q.map(s=>({"Trạng_thái":s.name,"Số_lượng":s.value})),{filename:`blog-status-${K}`}),children:"Export CSV"})]})]}),s.jsxs(y,{gutter:16,style:{marginBottom:16},children:[s.jsx(v,{span:6,children:s.jsx(B,{className:"shadow-card",children:s.jsx(E,{title:"Tổng bài viết",value:Y,prefix:s.jsx(b,{})})})}),s.jsx(v,{span:6,children:s.jsx(B,{className:"shadow-card",children:s.jsx(E,{title:"Chờ duyệt",value:D.pending||0,prefix:s.jsx(C,{style:{color:"#F59E0B"}}),valueStyle:{color:"#F59E0B"}})})}),s.jsx(v,{span:6,children:s.jsx(B,{className:"shadow-card",children:s.jsx(E,{title:"Đã xuất bản",value:D.published||0,prefix:s.jsx(F,{style:{color:"#10B981"}}),valueStyle:{color:"#10B981"}})})}),s.jsx(v,{span:6,children:s.jsx(B,{className:"shadow-card",children:s.jsx(E,{title:"Bị từ chối",value:D.rejected||0,prefix:s.jsx(P,{style:{color:"#F43F5E"}}),valueStyle:{color:"#F43F5E"}})})})]}),M?s.jsxs(y,{gutter:16,children:[s.jsx(v,{span:10,children:s.jsx(B,{className:"shadow-card",title:"Tỷ lệ theo trạng thái",children:s.jsx("div",{style:{height:320},children:s.jsx(a,{width:"100%",height:"100%",children:s.jsxs(t,{children:[s.jsx(l,{dataKey:"value",nameKey:"name",data:q,label:!0,children:q.map((e,a)=>s.jsx(i,{fill:e.color||T[a%T.length]},`cell-${a}`))}),s.jsx(r,{}),s.jsx(n,{})]})})})})}),s.jsx(v,{span:14,children:s.jsx(B,{className:"shadow-card",title:`Số bài viết theo tháng (${K})`,children:s.jsx("div",{style:{height:320},children:s.jsx(a,{width:"100%",height:"100%",children:s.jsxs(o,{data:I,children:[s.jsx(c,{strokeDasharray:"3 3"}),s.jsx(d,{dataKey:"month"}),s.jsx(h,{allowDecimals:!1}),s.jsx(r,{}),s.jsx(j,{dataKey:"count",fill:"#0EA5E9",radius:[6,6,0,0]})]})})})})})]}):s.jsx(B,{children:s.jsx(S,{description:"Chưa có dữ liệu thống kê"})})]})})}export{K as default};
