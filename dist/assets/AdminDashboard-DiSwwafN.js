import{j as e}from"./vendor-CIDEvgjn.js";import{r as s,u as t}from"./react-YvAU7kAw.js";import{I as l,_ as n,T as i,C as a,h as r,i as o,S as c,t as d,o as x,u as h,v as j,e as u,A as g}from"./antd-B4HmBe3_.js";import{s as v}from"./subscriptionAPI-D834kGML.js";import{u as m,a as p,b as f,c as y}from"./queries-DJngcklj.js";import{b as S}from"./blogAPI-vI-S6GaM.js";import{a as b}from"./adminApiService-B11Tsdp0.js";import"./index-CkXcCt97.js";import{R,a as T,b as U,c as w,d as z,e as I}from"./index-CWIbmrm_.js";import{R as A}from"./ShoppingOutlined-9IF0MCvx.js";import{R as C}from"./PieChartOutlined-BzTw6l7c.js";import{R as k}from"./DollarOutlined-BxcgP7yR.js";import{R as B,L as H,C as L,X as P,Y as O,T as q,a as D,b as E}from"./recharts-CeeJsarb.js";import"./ocrAPI-ivp9zvPg.js";import"./aiAPI-g6JlSqtA.js";import"./socket-CUkmNz_4.js";var F={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 248H728l-32.4-90.8a32.07 32.07 0 00-30.2-21.2H358.6c-13.5 0-25.6 8.5-30.1 21.2L296 248H160c-44.2 0-80 35.8-80 80v456c0 44.2 35.8 80 80 80h704c44.2 0 80-35.8 80-80V328c0-44.2-35.8-80-80-80zm8 536c0 4.4-3.6 8-8 8H160c-4.4 0-8-3.6-8-8V328c0-4.4 3.6-8 8-8h186.7l17.1-47.8 22.9-64.2h250.5l22.9 64.2 17.1 47.8H864c4.4 0 8 3.6 8 8v456zM512 384c-88.4 0-160 71.6-160 160s71.6 160 160 160 160-71.6 160-160-71.6-160-160-160zm0 256c-53 0-96-43-96-96s43-96 96-96 96 43 96 96-43 96-96 96z"}}]},name:"camera",theme:"outlined"},M=function(e,t){return s.createElement(l,n({},e,{ref:t,icon:F}))},K=s.forwardRef(M);const{Title:N,Text:V}=i,J=()=>{const l=t(),[n,i]=s.useState({totalUsers:0,totalRevenue:0,activeUsers:0}),[F,M]=s.useState({}),[J,X]=s.useState({totalRevenue:0}),[Y,_]=s.useState(!1),[G,Q]=s.useState([]),[W,Z]=s.useState([]),{data:$,isLoading:ee}=m(),{data:se,isLoading:te}=p(),{data:le,isLoading:ne}=f(),{data:ie,isLoading:ae}=y();s.useEffect(()=>{re(),oe()},[]);const re=async()=>{try{let s=0,t=0,l=0;try{const e=await b.getUserStats(),l=(null==e?void 0:e.data)||e||{};s=l.total||l.totalUsers||0,t=l.active||l.activeUsers||0}catch(e){}try{const e=await v.getRevenueTotals();if(e){l=(e.data||e).totalRevenue||0}}catch(e){}i({totalUsers:s,totalRevenue:l,activeUsers:t}),Z([]),Q([])}catch(e){i({totalUsers:0,totalRevenue:0,activeUsers:0}),Q([])}},oe=async()=>{var e;_(!0);try{const[s,t]=await Promise.allSettled([S.getStatusStats(),v.getRevenueTotals()]);if("fulfilled"===s.status&&s.value?M(s.value||{}):M({}),"fulfilled"===t.status&&t.value){const s=(null==(e=t.value)?void 0:e.data)||t.value||{totalRevenue:0};X(s)}else X({totalRevenue:0})}catch(s){M({}),X({totalRevenue:0})}finally{_(!1)}},ce=s=>{switch(s){case"expense":return e.jsx(k,{style:{color:"#1890ff"}});case"register":return e.jsx(w,{style:{color:"#52c41a"}});case"warning":return e.jsx(z,{style:{color:"#faad14"}});case"payment":return e.jsx(k,{style:{color:"#722ed1"}});default:return e.jsx(I,{})}};return e.jsxs("div",{style:{padding:"24px"},children:[e.jsx(N,{level:2,children:"Admin Dashboard"}),!1,e.jsx(a,{title:"Thống kê Hệ thống",style:{marginBottom:"24px"},children:e.jsxs(r,{gutter:[16,16],children:[e.jsx(o,{xs:24,sm:12,md:6,children:e.jsx(a,{hoverable:!0,children:e.jsx(c,{spinning:ee,indicator:e.jsx(x,{style:{fontSize:24}}),children:e.jsx(d,{title:"Số người dùng có chi tiêu",value:(null==$?void 0:$.totalUsers)||0,prefix:e.jsx(R,{}),valueStyle:{color:"#1890ff"}})})})}),e.jsx(o,{xs:24,sm:12,md:6,children:e.jsx(a,{hoverable:!0,children:e.jsx(c,{spinning:te,indicator:e.jsx(x,{style:{fontSize:24}}),children:e.jsx(d,{title:"Số người dùng có ngân sách",value:(null==se?void 0:se.totalUsers)||0,prefix:e.jsx(R,{}),valueStyle:{color:"#722ed1"}})})})}),e.jsx(o,{xs:24,sm:12,md:6,children:e.jsx(a,{hoverable:!0,children:e.jsx(c,{spinning:ee,indicator:e.jsx(x,{style:{fontSize:24}}),children:e.jsx(d,{title:"Tổng số chi tiêu",value:(null==$?void 0:$.totalExpenses)||0,prefix:e.jsx(A,{}),valueStyle:{color:"#52c41a"}})})})}),e.jsx(o,{xs:24,sm:12,md:6,children:e.jsx(a,{hoverable:!0,children:e.jsx(c,{spinning:te,indicator:e.jsx(x,{style:{fontSize:24}}),children:e.jsx(d,{title:"Tổng số ngân sách",value:(null==se?void 0:se.totalBudgets)||0,prefix:e.jsx(C,{}),valueStyle:{color:"#faad14"}})})})}),e.jsx(o,{xs:24,sm:12,md:6,children:e.jsx(a,{hoverable:!0,children:e.jsx(c,{spinning:ne,indicator:e.jsx(x,{style:{fontSize:24}}),children:e.jsx(d,{title:"Tổng số lượt quét OCR",value:(null==le?void 0:le.totalJobs)||0,prefix:e.jsx(T,{}),valueStyle:{color:"#13c2c2"}})})})}),e.jsx(o,{xs:24,sm:12,md:6,children:e.jsx(a,{hoverable:!0,children:e.jsx(c,{spinning:ne,indicator:e.jsx(x,{style:{fontSize:24}}),children:e.jsx(d,{title:"Số người dùng dùng OCR",value:(null==le?void 0:le.totalUsers)||0,prefix:e.jsx(K,{}),valueStyle:{color:"#eb2f96"}})})})}),e.jsx(o,{xs:24,sm:12,md:6,children:e.jsx(a,{hoverable:!0,children:e.jsx(c,{spinning:ae,indicator:e.jsx(x,{style:{fontSize:24}}),children:e.jsx(d,{title:"Tổng yêu cầu AI",value:(null==ie?void 0:ie.totalRequests)||0,prefix:e.jsx(U,{}),valueStyle:{color:"#8B5CF6"}})})})}),e.jsx(o,{xs:24,sm:12,md:6,children:e.jsx(a,{hoverable:!0,children:e.jsx(c,{spinning:ae,indicator:e.jsx(x,{style:{fontSize:24}}),children:e.jsx(d,{title:"Người dùng dùng AI",value:(null==ie?void 0:ie.totalUsers)||0,prefix:e.jsx(w,{}),valueStyle:{color:"#6366F1"}})})})})]})}),e.jsx(a,{title:"Thống kê hệ thống chính",style:{marginBottom:"24px"},children:e.jsxs(r,{gutter:[16,16],children:[e.jsx(o,{xs:24,sm:12,lg:6,children:e.jsx(a,{hoverable:!0,children:e.jsx(d,{title:"Tổng người dùng",value:n.totalUsers,prefix:e.jsx(R,{}),valueStyle:{color:"#3f8600"}})})}),e.jsx(o,{xs:24,sm:12,lg:6,children:e.jsx(a,{hoverable:!0,children:e.jsx(d,{title:"Người dùng hoạt động",value:n.activeUsers,prefix:e.jsx(w,{}),valueStyle:{color:"#1890ff"}})})}),e.jsx(o,{xs:24,sm:12,lg:6,children:e.jsx(a,{hoverable:!0,children:e.jsx(d,{title:"Tổng doanh thu",value:n.totalRevenue,prefix:e.jsx(k,{}),suffix:"đ",valueStyle:{color:"#722ed1"}})})}),e.jsx(o,{xs:24,sm:12,lg:6,children:e.jsxs(a,{hoverable:!0,loading:Y,onClick:()=>l("/admin/blogs/pending"),children:[e.jsx(d,{title:"Blog chờ duyệt",value:F.pending||0,prefix:e.jsx(z,{}),valueStyle:{color:"#F59E0B"}}),e.jsxs(h,{color:"blue",style:{marginTop:8},children:["Tổng: ",(F.pending||0)+(F.published||0)+(F.rejected||0)+(F.draft||0)]})]})})]})}),e.jsxs(r,{gutter:[16,16],style:{marginBottom:"24px"},children:[e.jsx(o,{xs:24,lg:16,children:e.jsxs(a,{title:"Thống kê theo tháng",children:[e.jsx("div",{style:{width:"100%",height:300,minHeight:300},children:W.length>0?e.jsx(B,{width:"100%",height:"100%",children:e.jsxs(H,{data:W,children:[e.jsx(L,{strokeDasharray:"3 3"}),e.jsx(P,{dataKey:"month"}),e.jsx(O,{}),e.jsx(q,{}),e.jsx(D,{}),e.jsx(E,{type:"monotone",dataKey:"revenue",stroke:"#82ca9d",name:"Doanh thu"})]})}):e.jsx("div",{style:{textAlign:"center",padding:"80px 0"},children:e.jsx(V,{type:"secondary",children:"Chưa có dữ liệu thống kê"})})}),"          "]})}),e.jsx(o,{xs:24,lg:8,children:e.jsx(a,{title:"Thông báo nhanh",children:e.jsx(j,{dataSource:[],locale:{emptyText:"Chưa có thông báo"},renderItem:s=>e.jsx(j.Item,{children:e.jsxs(u,{style:{width:"100%",justifyContent:"space-between"},children:[e.jsx(V,{children:s.title}),e.jsx(h,{color:s.status,children:s.count})]})})})})})]}),e.jsx(r,{gutter:[16,16],children:e.jsx(o,{xs:24,children:e.jsx(a,{title:"Hoạt động gần đây",children:G.length>0?e.jsx(j,{dataSource:G,renderItem:s=>e.jsx(j.Item,{children:e.jsx(j.Item.Meta,{avatar:e.jsx(g,{icon:ce(s.type)}),title:e.jsxs(u,{children:[e.jsx(V,{strong:!0,children:s.user}),e.jsx(V,{type:"secondary",children:s.action}),s.amount&&e.jsx(V,{type:"success",children:s.amount})]}),description:s.time})})}):e.jsx("div",{style:{textAlign:"center",padding:"40px 0"},children:e.jsx(V,{type:"secondary",children:"Chưa có hoạt động gần đây"})})})})})]})};export{J as default};
